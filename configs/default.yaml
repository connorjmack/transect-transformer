# CliffCast Default Configuration
# Full model configuration with all prediction heads enabled

# Model architecture
model:
  d_model: 256
  n_heads: 8
  n_layers_transect: 4
  n_layers_env: 3
  n_layers_fusion: 2
  dropout: 0.1

  # Input dimensions
  n_point_features: 5    # elevation, slope, curvature, roughness, aspect
  n_meta_features: 7     # cliff_height, mean_slope, max_slope, toe_elevation, orientation, lat, lon
  n_wave_features: 4     # hs, tp, dp, power
  n_atmos_features: 24   # See data.atmos_feature_names for full list

  # Prediction heads (toggle for phased training)
  enable_risk: true
  enable_retreat: true
  enable_collapse: true
  enable_failure_mode: true

  # Head-specific parameters
  n_collapse_horizons: 4  # 1wk, 1mo, 3mo, 1yr
  n_failure_modes: 5      # stable, topple, planar, rotational, rockfall

# Data
data:
  n_transect_points: 128

  # Wave data (CDIP MOP alongshore predictions)
  wave_data_dir: data/raw/cdip
  wave_history_days: 90
  wave_timestep_hours: 6
  n_wave_features: 4
  wave_feature_names:
    - hs          # Significant wave height (m)
    - tp          # Peak period (s)
    - dp          # Peak direction (deg from N, 0=north, 90=east)
    - power       # Wave power flux (kW/m)

  # Atmospheric data (precipitation + temperature)
  atmos_history_days: 90
  atmos_timestep_hours: 24
  n_atmos_features: 24
  atmos_feature_names:
    # Raw measurements (5)
    - precip_mm
    - temp_mean_c
    - temp_min_c
    - temp_max_c
    - dewpoint_c
    # Cumulative precipitation (4)
    - precip_7d
    - precip_30d
    - precip_60d
    - precip_90d
    # Antecedent conditions (3)
    - api
    - days_since_rain
    - consecutive_dry_days
    # Intensity (4)
    - rain_day_flag
    - intensity_class
    - max_precip_7d
    - max_precip_30d
    # Wetting/drying cycles (2)
    - wet_dry_cycles_30d
    - wet_dry_cycles_90d
    # Evaporative demand (2)
    - vpd
    - vpd_7d_mean
    # Freeze-thaw (4)
    - freeze_flag
    - marginal_freeze_flag
    - freeze_thaw_cycles_30d
    - freeze_thaw_cycles_season
  atmos_data_dir: data/processed/atmospheric

  # Normalization
  normalize_elevation: true
  normalize_to_toe: true  # Set toe as origin

  # Train/val/test splits (percentages)
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15

  # Random seed for reproducibility
  seed: 42

# Training
training:
  batch_size: 32
  learning_rate: 1.0e-4
  weight_decay: 1.0e-5
  max_epochs: 100
  warmup_epochs: 5

  # Gradient clipping
  gradient_clip_val: 1.0

  # Mixed precision training
  use_amp: true

  # Loss weights
  loss_weight_risk: 1.0
  loss_weight_retreat: 1.0
  loss_weight_collapse: 2.0  # Higher: safety-critical
  loss_weight_mode: 0.5      # Lower: fewer labels

  # Early stopping
  early_stopping_patience: 15
  early_stopping_metric: val_loss
  early_stopping_mode: min

  # Checkpointing
  save_top_k: 3
  checkpoint_metric: val_loss
  checkpoint_mode: min

  # Scheduler
  scheduler: cosine
  min_lr: 1.0e-6

# Logging
logging:
  project_name: cliffcast
  log_every_n_steps: 10
  log_dir: logs

  # Weights & Biases
  use_wandb: true
  wandb_entity: null  # Set to your W&B username
  wandb_project: cliffcast

  # Save visualizations during training
  log_attention_maps: true
  log_predictions: true
  log_freq_epochs: 5

# Evaluation
evaluation:
  # Metrics to compute
  compute_r2: true
  compute_mae: true
  compute_rmse: true
  compute_auc: true
  compute_calibration: true

  # Calibration bins
  calibration_bins: 10

# Paths
paths:
  data_dir: data/processed
  checkpoint_dir: checkpoints
  output_dir: outputs
  results_dir: results
